---
import BaseLayout from "../../layouts/BaseLayout.astro";
---

<BaseLayout
    title="December 27, 2025 Benchmark | QAIL"
    description="QAIL-PHP is 2.6x faster than Eloquent! QAIL-Go is 4x faster than GORM."
>
    <style>
        .big-number {
            font-size: 6rem;
            font-weight: 900;
            background: linear-gradient(135deg, #22c55e, #06b6d4);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin: 1.5rem 0;
        }

        .benchmark-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            font-family: "JetBrains Mono", monospace;
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 8px;
            overflow: hidden;
        }

        .benchmark-table th,
        .benchmark-table td {
            padding: 1rem;
            text-align: right;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .benchmark-table th {
            background: var(--surface-2);
            color: var(--text-muted);
            font-weight: 600;
        }

        .benchmark-table td:first-child {
            text-align: left;
            color: var(--text);
        }

        .benchmark-table .winner {
            color: var(--accent);
            font-weight: bold;
        }

        .speedup-badge {
            display: inline-block;
            background: linear-gradient(
                135deg,
                var(--accent),
                var(--secondary)
            );
            color: var(--bg);
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .highlight-card {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            text-align: center;
        }

        .highlight-card h3 {
            color: #fff;
            margin: 0 0 1rem;
        }

        .highlight-card .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            color: #e2e8f0;
        }

        .stats-item {
            font-size: 1.25rem;
        }

        .stats-label {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .lang-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .lang-card {
            background: var(--surface-2);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .lang-card h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
    </style>

    <header class="page-header" style="text-align: center;">
        <div class="container">
            <p style="color: var(--text-muted); margin-bottom: 0.5rem;">
                December 27, 2025
            </p>
            <h1>Cross-Language Performance</h1>
            <p class="subtitle">
                PHP, Go, and Python benchmarks against native ORMs
            </p>

            <div class="big-number">2.6x</div>
            <p style="color: var(--text-muted); font-size: 1.25rem;">
                faster than Laravel Eloquent (single-query, fair comparison)
            </p>
        </div>
    </header>

    <main class="page-content">
        <div class="container">
            <!-- Section 1: PHP Extension Benchmark -->
            <section style="margin-bottom: 3rem;">
                <h2
                    style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;"
                >
                    üêò PHP Extension (Single Query - Fair Comparison)
                </h2>
                <p
                    style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;"
                >
                    Native C extension wrapping Rust ‚Ä¢ Same query pattern as
                    Eloquent (no batching)
                </p>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Implementation</th>
                            <th>Queries/Second</th>
                            <th>vs Eloquent</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>qail-php (Single)</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/php.svg"
                                    alt="PHP"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> Extension ‚Üí <img
                                    src="/icons/rust.svg"
                                    alt="Rust"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin: 0 4px;"
                                /> Rust core</td
                            >
                            <td class="winner">31,219 üèÜ</td>
                            <td><span class="speedup-badge">2.6x</span></td>
                        </tr>
                        <tr>
                            <td><strong>Raw PDO</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/php.svg"
                                    alt="PHP"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> Prepared statements</td
                            >
                            <td>31,271</td>
                            <td><span class="speedup-badge">2.6x</span></td>
                        </tr>
                        <tr>
                            <td><strong>Eloquent-like</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/php.svg"
                                    alt="PHP"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> PDO + model hydration</td
                            >
                            <td>11,537</td>
                            <td>baseline</td>
                        </tr>
                    </tbody>
                </table>

                <div
                    class="highlight-card"
                    style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);"
                >
                    <h3>üöÄ QAIL ‚âà PDO in single-query mode!</h3>
                    <p style="color: #e2e8f0; margin: 0; font-size: 1.1rem;">
                        Pipeline mode + direct wire protocol = no libpq overhead
                    </p>
                </div>
            </section>

            <!-- Section 2: Go CGO Benchmark -->
            <section style="margin-bottom: 3rem;">
                <h2
                    style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;"
                >
                    üêπ Go Driver (CGO)
                </h2>
                <p
                    style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;"
                >
                    CGO calling Rust static library ‚Ä¢ 1,000 queries per batch
                </p>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Implementation</th>
                            <th>Queries/Second</th>
                            <th>vs GORM</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>pgx</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/go.svg"
                                    alt="Go"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> Pure Go, optimized</td
                            >
                            <td class="winner">239,000 üèÜ</td>
                            <td><span class="speedup-badge">8.8x</span></td>
                        </tr>
                        <tr>
                            <td><strong>qail-go</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/go.svg"
                                    alt="Go"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> CGO ‚Üí <img
                                    src="/icons/rust.svg"
                                    alt="Rust"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin: 0 4px;"
                                /> Rust core</td
                            >
                            <td>126,000</td>
                            <td><span class="speedup-badge">4.2x</span></td>
                        </tr>
                        <tr>
                            <td><strong>GORM</strong></td>
                            <td style="text-align: left;"
                                ><img
                                    src="/icons/go.svg"
                                    alt="Go"
                                    width="16"
                                    height="16"
                                    style="vertical-align: middle; margin-right: 4px;"
                                /> ORM overhead</td
                            >
                            <td>27,000</td>
                            <td>baseline</td>
                        </tr>
                    </tbody>
                </table>

                <div
                    class="highlight-card"
                    style="background: linear-gradient(135deg, #0891b2 0%, #0284c7 100%);"
                >
                    <h3>üìä 4.2x faster than GORM</h3>
                    <p style="color: #e2e8f0; margin: 0; font-size: 1.1rem;">
                        CGO overhead limits vs pure Go pgx ‚Ä¢ Still much faster
                        than ORMs!
                    </p>
                </div>
            </section>

            <!-- Section 3: Zig Driver (DETAILED FAIR BENCHMARK) -->
            <section style="margin-bottom: 3rem;">
                <h2
                    style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;"
                >
                    ‚ö° Zig vs pg.zig (Fair Comparison)
                </h2>
                <p
                    style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;"
                >
                    Both drivers parse responses ‚Ä¢ Apples-to-apples comparison
                </p>

                <!-- The Story -->
                <div
                    style="background: var(--surface-2); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; border-left: 4px solid #f97316;"
                >
                    <h4 style="margin: 0 0 1rem; color: #f97316;">
                        üìñ The Benchmark Story
                    </h4>
                    <p style="color: var(--text-muted); margin: 0 0 1rem;">
                        Initial tests showed QAIL-Zig was <strong
                            >2.1x faster</strong
                        > than pg.zig. But wait‚Äîwas this a fair comparison?
                    </p>
                    <ul
                        style="color: var(--text-muted); margin: 0; padding-left: 1.5rem;"
                    >
                        <li>
                            <strong>pg.zig:</strong> Uses Extended Query protocol
                            (4 messages), parses responses, extracts typed values
                        </li>
                        <li>
                            <strong>QAIL-Zig (initial):</strong> Simple Query protocol,
                            <em>no response parsing</em>‚Äîonly encoding!
                        </li>
                    </ul>
                    <p style="color: var(--text-muted); margin: 1rem 0 0;">
                        So we built <strong>response parsing FFI</strong> to make
                        it fair. Result? <strong>Still 2x faster!</strong>
                    </p>
                </div>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Work Done</th>
                            <th>Queries/Second</th>
                            <th>Rows Parsed</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>QAIL-Zig</strong></td>
                            <td style="text-align: left;">
                                ‚ö° Zig + Rust FFI ‚Üí Parse responses
                            </td>
                            <td class="winner">33,866 üèÜ</td>
                            <td>55,000</td>
                        </tr>
                        <tr>
                            <td><strong>pg.zig</strong></td>
                            <td style="text-align: left;">
                                Pure Zig ‚Üí Parse responses
                            </td>
                            <td>16,990</td>
                            <td>55,000</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Technical Details -->
                <div
                    style="background: var(--surface-2); border-radius: 12px; padding: 1.5rem; margin: 2rem 0;"
                >
                    <h4 style="margin: 0 0 1rem; color: var(--primary);">
                        üîß What We Built
                    </h4>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;"
                    >
                        <div>
                            <h5
                                style="color: var(--accent); margin: 0 0 0.5rem;"
                            >
                                Response Parsing FFI
                            </h5>
                            <code
                                style="font-size: 0.85rem; color: var(--text-muted); display: block;"
                            >
                                qail_decode_response()<br />
                                qail_response_get_i32()<br />
                                qail_response_get_string()<br />
                                qail_response_free()
                            </code>
                        </div>
                        <div>
                            <h5
                                style="color: var(--accent); margin: 0 0 0.5rem;"
                            >
                                Linker Fix
                            </h5>
                            <p
                                style="color: var(--text-muted); margin: 0; font-size: 0.9rem;"
                            >
                                Static library (119MB) caused segfaults.<br />
                                Dynamic library (1.7MB) works perfectly!
                            </p>
                        </div>
                    </div>
                </div>

                <div
                    class="highlight-card"
                    style="background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);"
                >
                    <h3>üî• QAIL-Zig is 2.0x faster (fair comparison!)</h3>
                    <p style="color: #e2e8f0; margin: 0; font-size: 1.1rem;">
                        Both parse 55,000 rows ‚Ä¢ Same I/O work ‚Ä¢ Rust-optimized
                        parsing wins
                    </p>
                </div>

                <!-- Why Faster -->
                <div style="margin-top: 2rem;">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">
                        Why is QAIL Still Faster?
                    </h4>
                    <div class="lang-grid">
                        <div class="lang-card">
                            <h5
                                style="margin: 0 0 0.5rem; color: var(--accent);"
                            >
                                1. Simple Query Protocol
                            </h5>
                            <p
                                style="color: var(--text-muted); margin: 0; font-size: 0.9rem;"
                            >
                                1 message vs 4 messages (Parse, Bind, Execute,
                                Sync)
                            </p>
                        </div>
                        <div class="lang-card">
                            <h5
                                style="margin: 0 0 0.5rem; color: var(--accent);"
                            >
                                2. Rust-Optimized Parsing
                            </h5>
                            <p
                                style="color: var(--text-muted); margin: 0; font-size: 0.9rem;"
                            >
                                Battle-tested wire protocol decoder from qail-pg
                            </p>
                        </div>
                        <div class="lang-card">
                            <h5
                                style="margin: 0 0 0.5rem; color: var(--accent);"
                            >
                                3. Zero Allocation
                            </h5>
                            <p
                                style="color: var(--text-muted); margin: 0; font-size: 0.9rem;"
                            >
                                QAIL reuses buffers; pg.zig allocates per-query
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cross-Language Summary -->
            <section style="margin-bottom: 3rem;">
                <h2
                    style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;"
                >
                    üìä Cross-Language Summary
                </h2>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Query Speed</th>
                            <th>vs ORM</th>
                            <th>% of Rust</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Native Rust</strong></td>
                            <td class="winner">354K q/s ü•á</td>
                            <td>N/A</td>
                            <td>100%</td>
                        </tr>
                        <tr>
                            <td><strong>qail-zig</strong></td>
                            <td>34K q/s</td>
                            <td
                                ><span class="speedup-badge">2.0x pg.zig</span
                                ></td
                            >
                            <td>N/A*</td>
                        </tr>
                        <tr>
                            <td><strong>qail-php (single)</strong></td>
                            <td>31K q/s</td>
                            <td
                                ><span class="speedup-badge">2.6x Eloquent</span
                                ></td
                            >
                            <td>9%</td>
                        </tr>
                        <tr>
                            <td><strong>qail-go (CGO)</strong></td>
                            <td>126K q/s</td>
                            <td><span class="speedup-badge">4.2x GORM</span></td
                            >
                            <td>36%</td>
                        </tr>
                        <tr>
                            <td><strong>qail-py (PyO3)</strong></td>
                            <td>122K q/s</td>
                            <td
                                ><span class="speedup-badge">7.6x asyncpg</span
                                ></td
                            >
                            <td>35%</td>
                        </tr>
                    </tbody>
                </table>

                <div class="highlight-card">
                    <div
                        class="stats"
                        style="grid-template-columns: repeat(4, 1fr);"
                    >
                        <div>
                            <div class="stats-item">2.0x</div>
                            <div class="stats-label">Zig vs pg.zig</div>
                        </div>
                        <div>
                            <div class="stats-item">2.6x</div>
                            <div class="stats-label">PHP vs Eloquent</div>
                        </div>
                        <div>
                            <div class="stats-item">7.6x</div>
                            <div class="stats-label">Python vs asyncpg</div>
                        </div>
                        <div>
                            <div class="stats-item">4.2x</div>
                            <div class="stats-label">Go vs GORM</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CTA -->
            <section style="text-align: center; padding: 3rem 0;">
                <h2
                    style="font-size: 2rem; margin-bottom: 1rem; color: var(--text);"
                >
                    Try QAIL Today
                </h2>
                <p
                    style="font-size: 1.25rem; color: var(--text-muted); max-width: 600px; margin: 0 auto 2rem;"
                >
                    The fastest database driver for PHP, Python, Go, and Rust.
                </p>

                <a
                    href="https://github.com/qail-io/qail"
                    target="_blank"
                    class="btn btn-primary"
                    style="margin-top: 1rem; display: inline-flex; align-items: center; gap: 0.5rem;"
                >
                    <svg
                        height="20"
                        width="20"
                        viewBox="0 0 16 16"
                        fill="currentColor"
                    >
                        <path
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
                        ></path>
                    </svg>
                    Star on GitHub
                </a>

                <p style="margin-top: 2rem;">
                    <a href="/benchmarks" style="color: var(--primary);"
                        >‚Üê Back to all benchmarks</a
                    >
                </p>
            </section>
        </div>
    </main>
</BaseLayout>
